{"ast":null,"code":"import { BufferAttribute, BufferGeometry, Color, Line, LineBasicMaterial, Matrix4, Mesh, MeshBasicMaterial, Object3D, Quaternion, SphereGeometry, Vector3 } from 'three';\nconst _quaternion = new Quaternion();\nconst _targetPos = new Vector3();\nconst _targetVec = new Vector3();\nconst _effectorPos = new Vector3();\nconst _effectorVec = new Vector3();\nconst _linkPos = new Vector3();\nconst _invLinkQ = new Quaternion();\nconst _linkScale = new Vector3();\nconst _axis = new Vector3();\nconst _vector = new Vector3();\nconst _matrix = new Matrix4();\n\n/**\n * This class solves the Inverse Kinematics Problem with a [CCD Algorithm]{@link https://web.archive.org/web/20221206080850/https://sites.google.com/site/auraliusproject/ccd-algorithm}.\n *\n * `CCDIKSolver` is designed to work with instances of {@link SkinnedMesh}.\n *\n * @three_import import { CCDIKSolver } from 'three/addons/animation/CCDIKSolver.js';\n */\nclass CCDIKSolver {\n  /**\n   * @param {SkinnedMesh} mesh - The skinned mesh.\n   * @param {Array<CCDIKSolver~IK>} [iks=[]] - The IK objects.\n   */\n  constructor(mesh, iks = []) {\n    /**\n     * The skinned mesh.\n     *\n     * @type {SkinnedMesh}\n     */\n    this.mesh = mesh;\n\n    /**\n     * The IK objects.\n     *\n     * @type {SkinnedMesh}\n     */\n    this.iks = iks;\n    this._initialQuaternions = [];\n    this._workingQuaternion = new Quaternion();\n    for (const ik of iks) {\n      const chainQuats = [];\n      for (let i = 0; i < ik.links.length; i++) {\n        chainQuats.push(new Quaternion());\n      }\n      this._initialQuaternions.push(chainQuats);\n    }\n    this._valid();\n  }\n\n  /**\n   * Updates all IK bones by solving the CCD algorithm.\n   *\n   * @param {number} [globalBlendFactor=1.0] - Blend factor applied if an IK chain doesn't have its own .blendFactor.\n   * @return {CCDIKSolver} A reference to this instance.\n   */\n  update(globalBlendFactor = 1.0) {\n    const iks = this.iks;\n    for (let i = 0, il = iks.length; i < il; i++) {\n      this.updateOne(iks[i], globalBlendFactor);\n    }\n    return this;\n  }\n\n  /**\n   * Updates one IK bone solving the CCD algorithm.\n   *\n   * @param {CCDIKSolver~IK} ik - The IK to update.\n   * @param {number} [overrideBlend=1.0] - If the IK object does not define `blendFactor`, this value is used.\n   * @return {CCDIKSolver} A reference to this instance.\n   */\n  updateOne(ik, overrideBlend = 1.0) {\n    const chainBlend = ik.blendFactor !== undefined ? ik.blendFactor : overrideBlend;\n    const bones = this.mesh.skeleton.bones;\n    const chainIndex = this.iks.indexOf(ik);\n    const initialQuaternions = this._initialQuaternions[chainIndex];\n\n    // for reference overhead reduction in loop\n    const math = Math;\n    const effector = bones[ik.effector];\n    const target = bones[ik.target];\n\n    // don't use getWorldPosition() here for the performance\n    // because it calls updateMatrixWorld( true ) inside.\n    _targetPos.setFromMatrixPosition(target.matrixWorld);\n    const links = ik.links;\n    const iteration = ik.iteration !== undefined ? ik.iteration : 1;\n    if (chainBlend < 1.0) {\n      for (let j = 0; j < links.length; j++) {\n        const linkIndex = links[j].index;\n        initialQuaternions[j].copy(bones[linkIndex].quaternion);\n      }\n    }\n    for (let i = 0; i < iteration; i++) {\n      let rotated = false;\n      for (let j = 0, jl = links.length; j < jl; j++) {\n        const link = bones[links[j].index];\n\n        // skip this link and following links\n        if (links[j].enabled === false) break;\n        const limitation = links[j].limitation;\n        const rotationMin = links[j].rotationMin;\n        const rotationMax = links[j].rotationMax;\n\n        // don't use getWorldPosition/Quaternion() here for the performance\n        // because they call updateMatrixWorld( true ) inside.\n        link.matrixWorld.decompose(_linkPos, _invLinkQ, _linkScale);\n        _invLinkQ.invert();\n        _effectorPos.setFromMatrixPosition(effector.matrixWorld);\n\n        // work in link world\n        _effectorVec.subVectors(_effectorPos, _linkPos);\n        _effectorVec.applyQuaternion(_invLinkQ);\n        _effectorVec.normalize();\n        _targetVec.subVectors(_targetPos, _linkPos);\n        _targetVec.applyQuaternion(_invLinkQ);\n        _targetVec.normalize();\n        let angle = _targetVec.dot(_effectorVec);\n        if (angle > 1.0) {\n          angle = 1.0;\n        } else if (angle < -1.0) {\n          angle = -1.0;\n        }\n        angle = math.acos(angle);\n\n        // skip if changing angle is too small to prevent vibration of bone\n        if (angle < 1e-5) continue;\n        if (ik.minAngle !== undefined && angle < ik.minAngle) {\n          angle = ik.minAngle;\n        }\n        if (ik.maxAngle !== undefined && angle > ik.maxAngle) {\n          angle = ik.maxAngle;\n        }\n        _axis.crossVectors(_effectorVec, _targetVec);\n        _axis.normalize();\n        _quaternion.setFromAxisAngle(_axis, angle);\n        link.quaternion.multiply(_quaternion);\n\n        // TODO: re-consider the limitation specification\n        if (limitation !== undefined) {\n          let c = link.quaternion.w;\n          if (c > 1.0) c = 1.0;\n          const c2 = math.sqrt(1 - c * c);\n          link.quaternion.set(limitation.x * c2, limitation.y * c2, limitation.z * c2, c);\n        }\n        if (rotationMin !== undefined) {\n          link.rotation.setFromVector3(_vector.setFromEuler(link.rotation).max(rotationMin));\n        }\n        if (rotationMax !== undefined) {\n          link.rotation.setFromVector3(_vector.setFromEuler(link.rotation).min(rotationMax));\n        }\n        link.updateMatrixWorld(true);\n        rotated = true;\n      }\n      if (!rotated) break;\n    }\n    if (chainBlend < 1.0) {\n      for (let j = 0; j < links.length; j++) {\n        const linkIndex = links[j].index;\n        const link = bones[linkIndex];\n        this._workingQuaternion.copy(initialQuaternions[j]).slerp(link.quaternion, chainBlend);\n        link.quaternion.copy(this._workingQuaternion);\n        link.updateMatrixWorld(true);\n      }\n    }\n    return this;\n  }\n\n  /**\n   * Creates a helper for visualizing the CCDIK.\n   *\n   * @param {number} sphereSize - The sphere size.\n   * @return {CCDIKHelper} The created helper.\n   */\n  createHelper(sphereSize) {\n    return new CCDIKHelper(this.mesh, this.iks, sphereSize);\n  }\n\n  // private methods\n\n  _valid() {\n    const iks = this.iks;\n    const bones = this.mesh.skeleton.bones;\n    for (let i = 0, il = iks.length; i < il; i++) {\n      const ik = iks[i];\n      const effector = bones[ik.effector];\n      const links = ik.links;\n      let link0, link1;\n      link0 = effector;\n      for (let j = 0, jl = links.length; j < jl; j++) {\n        link1 = bones[links[j].index];\n        if (link0.parent !== link1) {\n          console.warn('THREE.CCDIKSolver: bone ' + link0.name + ' is not the child of bone ' + link1.name);\n        }\n        link0 = link1;\n      }\n    }\n  }\n}\nfunction getPosition(bone, matrixWorldInv) {\n  return _vector.setFromMatrixPosition(bone.matrixWorld).applyMatrix4(matrixWorldInv);\n}\nfunction setPositionOfBoneToAttributeArray(array, index, bone, matrixWorldInv) {\n  const v = getPosition(bone, matrixWorldInv);\n  array[index * 3 + 0] = v.x;\n  array[index * 3 + 1] = v.y;\n  array[index * 3 + 2] = v.z;\n}\n\n/**\n * Helper for visualizing IK bones.\n *\n * @augments Object3D\n * @three_import import { CCDIKHelper } from 'three/addons/animation/CCDIKSolver.js';\n */\nclass CCDIKHelper extends Object3D {\n  /**\n   * @param {SkinnedMesh} mesh - The skinned mesh.\n  \t * @param {Array<CCDIKSolver~IK>} [iks=[]] - The IK objects.\n  \t * @param {number} [sphereSize=0.25] - The sphere size.\n   */\n  constructor(mesh, iks = [], sphereSize = 0.25) {\n    super();\n\n    /**\n     * The skinned mesh this helper refers to.\n     *\n     * @type {SkinnedMesh}\n     */\n    this.root = mesh;\n\n    /**\n     * The IK objects.\n     *\n     * @type {Array<CCDIKSolver~IK>}\n     */\n    this.iks = iks;\n    this.matrix.copy(mesh.matrixWorld);\n    this.matrixAutoUpdate = false;\n\n    /**\n     * The helpers sphere geometry.\n     *\n     * @type {SkinnedMesh}\n     */\n    this.sphereGeometry = new SphereGeometry(sphereSize, 16, 8);\n\n    /**\n     * The material for the target spheres.\n     *\n     * @type {MeshBasicMaterial}\n     */\n    this.targetSphereMaterial = new MeshBasicMaterial({\n      color: new Color(0xff8888),\n      depthTest: false,\n      depthWrite: false,\n      transparent: true\n    });\n\n    /**\n     * The material for the effector spheres.\n     *\n     * @type {MeshBasicMaterial}\n     */\n    this.effectorSphereMaterial = new MeshBasicMaterial({\n      color: new Color(0x88ff88),\n      depthTest: false,\n      depthWrite: false,\n      transparent: true\n    });\n\n    /**\n     * The material for the link spheres.\n     *\n     * @type {MeshBasicMaterial}\n     */\n    this.linkSphereMaterial = new MeshBasicMaterial({\n      color: new Color(0x8888ff),\n      depthTest: false,\n      depthWrite: false,\n      transparent: true\n    });\n\n    /**\n     * A global line material.\n     *\n     * @type {LineBasicMaterial}\n     */\n    this.lineMaterial = new LineBasicMaterial({\n      color: new Color(0xff0000),\n      depthTest: false,\n      depthWrite: false,\n      transparent: true\n    });\n    this._init();\n  }\n  updateMatrixWorld(force) {\n    const mesh = this.root;\n    if (this.visible) {\n      let offset = 0;\n      const iks = this.iks;\n      const bones = mesh.skeleton.bones;\n      _matrix.copy(mesh.matrixWorld).invert();\n      for (let i = 0, il = iks.length; i < il; i++) {\n        const ik = iks[i];\n        const targetBone = bones[ik.target];\n        const effectorBone = bones[ik.effector];\n        const targetMesh = this.children[offset++];\n        const effectorMesh = this.children[offset++];\n        targetMesh.position.copy(getPosition(targetBone, _matrix));\n        effectorMesh.position.copy(getPosition(effectorBone, _matrix));\n        for (let j = 0, jl = ik.links.length; j < jl; j++) {\n          const link = ik.links[j];\n          const linkBone = bones[link.index];\n          const linkMesh = this.children[offset++];\n          linkMesh.position.copy(getPosition(linkBone, _matrix));\n        }\n        const line = this.children[offset++];\n        const array = line.geometry.attributes.position.array;\n        setPositionOfBoneToAttributeArray(array, 0, targetBone, _matrix);\n        setPositionOfBoneToAttributeArray(array, 1, effectorBone, _matrix);\n        for (let j = 0, jl = ik.links.length; j < jl; j++) {\n          const link = ik.links[j];\n          const linkBone = bones[link.index];\n          setPositionOfBoneToAttributeArray(array, j + 2, linkBone, _matrix);\n        }\n        line.geometry.attributes.position.needsUpdate = true;\n      }\n    }\n    this.matrix.copy(mesh.matrixWorld);\n    super.updateMatrixWorld(force);\n  }\n\n  /**\n   * Frees the GPU-related resources allocated by this instance.\n   * Call this method whenever this instance is no longer used in your app.\n   */\n  dispose() {\n    this.sphereGeometry.dispose();\n    this.targetSphereMaterial.dispose();\n    this.effectorSphereMaterial.dispose();\n    this.linkSphereMaterial.dispose();\n    this.lineMaterial.dispose();\n    const children = this.children;\n    for (let i = 0; i < children.length; i++) {\n      const child = children[i];\n      if (child.isLine) child.geometry.dispose();\n    }\n  }\n\n  // private method\n\n  _init() {\n    const scope = this;\n    const iks = this.iks;\n    function createLineGeometry(ik) {\n      const geometry = new BufferGeometry();\n      const vertices = new Float32Array((2 + ik.links.length) * 3);\n      geometry.setAttribute('position', new BufferAttribute(vertices, 3));\n      return geometry;\n    }\n    function createTargetMesh() {\n      return new Mesh(scope.sphereGeometry, scope.targetSphereMaterial);\n    }\n    function createEffectorMesh() {\n      return new Mesh(scope.sphereGeometry, scope.effectorSphereMaterial);\n    }\n    function createLinkMesh() {\n      return new Mesh(scope.sphereGeometry, scope.linkSphereMaterial);\n    }\n    function createLine(ik) {\n      return new Line(createLineGeometry(ik), scope.lineMaterial);\n    }\n    for (let i = 0, il = iks.length; i < il; i++) {\n      const ik = iks[i];\n      this.add(createTargetMesh());\n      this.add(createEffectorMesh());\n      for (let j = 0, jl = ik.links.length; j < jl; j++) {\n        this.add(createLinkMesh());\n      }\n      this.add(createLine(ik));\n    }\n  }\n}\n\n/**\n * This type represents IK configuration objects.\n *\n * @typedef {Object} CCDIKSolver~IK\n * @property {number} target - The target bone index which refers to a bone in the `Skeleton.bones` array.\n * @property {number} effector - The effector bone index which refers to a bone in the `Skeleton.bones` array.\n * @property {Array<CCDIKSolver~BoneLink>} links - An array of bone links.\n * @property {number} [iteration=1] - Iteration number of calculation. Smaller is faster but less precise.\n * @property {number} [minAngle] - Minimum rotation angle in a step in radians.\n * @property {number} [maxAngle] - Minimum rotation angle in a step in radians.\n * @property {number} [blendFactor] - The blend factor.\n **/\n\n/**\n * This type represents bone links.\n *\n * @typedef {Object} CCDIKSolver~BoneLink\n * @property {number} index - The index of a linked bone which refers to a bone in the `Skeleton.bones` array.\n * @property {number} [limitation] - Rotation axis.\n * @property {number} [rotationMin] - Rotation minimum limit.\n * @property {number} [rotationMax] - Rotation maximum limit.\n * @property {boolean} [enabled=true] - Whether the link is enabled or not.\n **/\n\nexport { CCDIKSolver, CCDIKHelper };","map":{"version":3,"names":["BufferAttribute","BufferGeometry","Color","Line","LineBasicMaterial","Matrix4","Mesh","MeshBasicMaterial","Object3D","Quaternion","SphereGeometry","Vector3","_quaternion","_targetPos","_targetVec","_effectorPos","_effectorVec","_linkPos","_invLinkQ","_linkScale","_axis","_vector","_matrix","CCDIKSolver","constructor","mesh","iks","_initialQuaternions","_workingQuaternion","ik","chainQuats","i","links","length","push","_valid","update","globalBlendFactor","il","updateOne","overrideBlend","chainBlend","blendFactor","undefined","bones","skeleton","chainIndex","indexOf","initialQuaternions","math","Math","effector","target","setFromMatrixPosition","matrixWorld","iteration","j","linkIndex","index","copy","quaternion","rotated","jl","link","enabled","limitation","rotationMin","rotationMax","decompose","invert","subVectors","applyQuaternion","normalize","angle","dot","acos","minAngle","maxAngle","crossVectors","setFromAxisAngle","multiply","c","w","c2","sqrt","set","x","y","z","rotation","setFromVector3","setFromEuler","max","min","updateMatrixWorld","slerp","createHelper","sphereSize","CCDIKHelper","link0","link1","parent","console","warn","name","getPosition","bone","matrixWorldInv","applyMatrix4","setPositionOfBoneToAttributeArray","array","v","root","matrix","matrixAutoUpdate","sphereGeometry","targetSphereMaterial","color","depthTest","depthWrite","transparent","effectorSphereMaterial","linkSphereMaterial","lineMaterial","_init","force","visible","offset","targetBone","effectorBone","targetMesh","children","effectorMesh","position","linkBone","linkMesh","line","geometry","attributes","needsUpdate","dispose","child","isLine","scope","createLineGeometry","vertices","Float32Array","setAttribute","createTargetMesh","createEffectorMesh","createLinkMesh","createLine","add"],"sources":["/home/powqy/Desktop/Design/solar-system-orbits/node_modules/three/examples/jsm/animation/CCDIKSolver.js"],"sourcesContent":["import {\n\tBufferAttribute,\n\tBufferGeometry,\n\tColor,\n\tLine,\n\tLineBasicMaterial,\n\tMatrix4,\n\tMesh,\n\tMeshBasicMaterial,\n\tObject3D,\n\tQuaternion,\n\tSphereGeometry,\n\tVector3\n} from 'three';\n\nconst _quaternion = new Quaternion();\nconst _targetPos = new Vector3();\nconst _targetVec = new Vector3();\nconst _effectorPos = new Vector3();\nconst _effectorVec = new Vector3();\nconst _linkPos = new Vector3();\nconst _invLinkQ = new Quaternion();\nconst _linkScale = new Vector3();\nconst _axis = new Vector3();\nconst _vector = new Vector3();\nconst _matrix = new Matrix4();\n\n/**\n * This class solves the Inverse Kinematics Problem with a [CCD Algorithm]{@link https://web.archive.org/web/20221206080850/https://sites.google.com/site/auraliusproject/ccd-algorithm}.\n *\n * `CCDIKSolver` is designed to work with instances of {@link SkinnedMesh}.\n *\n * @three_import import { CCDIKSolver } from 'three/addons/animation/CCDIKSolver.js';\n */\nclass CCDIKSolver {\n\n\t/**\n\t * @param {SkinnedMesh} mesh - The skinned mesh.\n\t * @param {Array<CCDIKSolver~IK>} [iks=[]] - The IK objects.\n\t */\n\tconstructor( mesh, iks = [] ) {\n\n\t\t/**\n\t\t * The skinned mesh.\n\t\t *\n\t\t * @type {SkinnedMesh}\n\t\t */\n\t\tthis.mesh = mesh;\n\n\t\t/**\n\t\t * The IK objects.\n\t\t *\n\t\t * @type {SkinnedMesh}\n\t\t */\n\t\tthis.iks = iks;\n\n\t\tthis._initialQuaternions = [];\n\t\tthis._workingQuaternion = new Quaternion();\n\n\t\tfor ( const ik of iks ) {\n\n\t\t\tconst chainQuats = [];\n\t\t\tfor ( let i = 0; i < ik.links.length; i ++ ) {\n\n\t\t\t  chainQuats.push( new Quaternion() );\n\n\t\t\t}\n\n\t\t\tthis._initialQuaternions.push( chainQuats );\n\n\t\t}\n\n\t\tthis._valid();\n\n\t}\n\n\t/**\n\t * Updates all IK bones by solving the CCD algorithm.\n\t *\n\t * @param {number} [globalBlendFactor=1.0] - Blend factor applied if an IK chain doesn't have its own .blendFactor.\n\t * @return {CCDIKSolver} A reference to this instance.\n\t */\n\tupdate( globalBlendFactor = 1.0 ) {\n\n\t\tconst iks = this.iks;\n\n\t\tfor ( let i = 0, il = iks.length; i < il; i ++ ) {\n\n\t\t\tthis.updateOne( iks[ i ], globalBlendFactor );\n\n\t\t}\n\n\t\treturn this;\n\n\t}\n\n\t/**\n\t * Updates one IK bone solving the CCD algorithm.\n\t *\n\t * @param {CCDIKSolver~IK} ik - The IK to update.\n\t * @param {number} [overrideBlend=1.0] - If the IK object does not define `blendFactor`, this value is used.\n\t * @return {CCDIKSolver} A reference to this instance.\n\t */\n\tupdateOne( ik, overrideBlend = 1.0 ) {\n\n\t\tconst chainBlend = ik.blendFactor !== undefined ? ik.blendFactor : overrideBlend;\n\t\tconst bones = this.mesh.skeleton.bones;\n\t\tconst chainIndex = this.iks.indexOf( ik );\n\t\tconst initialQuaternions = this._initialQuaternions[ chainIndex ];\n\n\t\t// for reference overhead reduction in loop\n\t\tconst math = Math;\n\n\t\tconst effector = bones[ ik.effector ];\n\t\tconst target = bones[ ik.target ];\n\n\t\t// don't use getWorldPosition() here for the performance\n\t\t// because it calls updateMatrixWorld( true ) inside.\n\t\t_targetPos.setFromMatrixPosition( target.matrixWorld );\n\n\t\tconst links = ik.links;\n\t\tconst iteration = ik.iteration !== undefined ? ik.iteration : 1;\n\n\t\tif ( chainBlend < 1.0 ) {\n\n\t\t\tfor ( let j = 0; j < links.length; j ++ ) {\n\n\t\t\t  const linkIndex = links[ j ].index;\n\t\t\t  initialQuaternions[ j ].copy( bones[ linkIndex ].quaternion );\n\n\t\t\t}\n\n\t\t}\n\n\t\tfor ( let i = 0; i < iteration; i ++ ) {\n\n\t\t\tlet rotated = false;\n\n\t\t\tfor ( let j = 0, jl = links.length; j < jl; j ++ ) {\n\n\t\t\t\tconst link = bones[ links[ j ].index ];\n\n\t\t\t\t// skip this link and following links\n\t\t\t\tif ( links[ j ].enabled === false ) break;\n\n\t\t\t\tconst limitation = links[ j ].limitation;\n\t\t\t\tconst rotationMin = links[ j ].rotationMin;\n\t\t\t\tconst rotationMax = links[ j ].rotationMax;\n\n\t\t\t\t// don't use getWorldPosition/Quaternion() here for the performance\n\t\t\t\t// because they call updateMatrixWorld( true ) inside.\n\t\t\t\tlink.matrixWorld.decompose( _linkPos, _invLinkQ, _linkScale );\n\t\t\t\t_invLinkQ.invert();\n\t\t\t\t_effectorPos.setFromMatrixPosition( effector.matrixWorld );\n\n\t\t\t\t// work in link world\n\t\t\t\t_effectorVec.subVectors( _effectorPos, _linkPos );\n\t\t\t\t_effectorVec.applyQuaternion( _invLinkQ );\n\t\t\t\t_effectorVec.normalize();\n\n\t\t\t\t_targetVec.subVectors( _targetPos, _linkPos );\n\t\t\t\t_targetVec.applyQuaternion( _invLinkQ );\n\t\t\t\t_targetVec.normalize();\n\n\t\t\t\tlet angle = _targetVec.dot( _effectorVec );\n\n\t\t\t\tif ( angle > 1.0 ) {\n\n\t\t\t\t\tangle = 1.0;\n\n\t\t\t\t} else if ( angle < - 1.0 ) {\n\n\t\t\t\t\tangle = - 1.0;\n\n\t\t\t\t}\n\n\t\t\t\tangle = math.acos( angle );\n\n\t\t\t\t// skip if changing angle is too small to prevent vibration of bone\n\t\t\t\tif ( angle < 1e-5 ) continue;\n\n\t\t\t\tif ( ik.minAngle !== undefined && angle < ik.minAngle ) {\n\n\t\t\t\t\tangle = ik.minAngle;\n\n\t\t\t\t}\n\n\t\t\t\tif ( ik.maxAngle !== undefined && angle > ik.maxAngle ) {\n\n\t\t\t\t\tangle = ik.maxAngle;\n\n\t\t\t\t}\n\n\t\t\t\t_axis.crossVectors( _effectorVec, _targetVec );\n\t\t\t\t_axis.normalize();\n\n\t\t\t\t_quaternion.setFromAxisAngle( _axis, angle );\n\t\t\t\tlink.quaternion.multiply( _quaternion );\n\n\t\t\t\t// TODO: re-consider the limitation specification\n\t\t\t\tif ( limitation !== undefined ) {\n\n\t\t\t\t\tlet c = link.quaternion.w;\n\n\t\t\t\t\tif ( c > 1.0 ) c = 1.0;\n\n\t\t\t\t\tconst c2 = math.sqrt( 1 - c * c );\n\t\t\t\t\tlink.quaternion.set( limitation.x * c2,\n\t\t\t\t\t                     limitation.y * c2,\n\t\t\t\t\t                     limitation.z * c2,\n\t\t\t\t\t                     c );\n\n\t\t\t\t}\n\n\t\t\t\tif ( rotationMin !== undefined ) {\n\n\t\t\t\t\tlink.rotation.setFromVector3( _vector.setFromEuler( link.rotation ).max( rotationMin ) );\n\n\t\t\t\t}\n\n\t\t\t\tif ( rotationMax !== undefined ) {\n\n\t\t\t\t\tlink.rotation.setFromVector3( _vector.setFromEuler( link.rotation ).min( rotationMax ) );\n\n\t\t\t\t}\n\n\t\t\t\tlink.updateMatrixWorld( true );\n\n\t\t\t\trotated = true;\n\n\t\t\t}\n\n\t\t\tif ( ! rotated ) break;\n\n\t\t}\n\n\t\tif ( chainBlend < 1.0 ) {\n\n\t\t\tfor ( let j = 0; j < links.length; j ++ ) {\n\n\t\t\t  const linkIndex = links[ j ].index;\n\t\t\t  const link = bones[ linkIndex ];\n\n\t\t\t  this._workingQuaternion.copy( initialQuaternions[ j ] ).slerp( link.quaternion, chainBlend );\n\n\t\t\t  link.quaternion.copy( this._workingQuaternion );\n\t\t\t  link.updateMatrixWorld( true );\n\n\t\t\t}\n\n\t\t}\n\n\t\t  return this;\n\n\t}\n\n\t/**\n\t * Creates a helper for visualizing the CCDIK.\n\t *\n\t * @param {number} sphereSize - The sphere size.\n\t * @return {CCDIKHelper} The created helper.\n\t */\n\tcreateHelper( sphereSize ) {\n\n\t\treturn new CCDIKHelper( this.mesh, this.iks, sphereSize );\n\n\t}\n\n\t// private methods\n\n\t_valid() {\n\n\t\tconst iks = this.iks;\n\t\tconst bones = this.mesh.skeleton.bones;\n\n\t\tfor ( let i = 0, il = iks.length; i < il; i ++ ) {\n\n\t\t\tconst ik = iks[ i ];\n\t\t\tconst effector = bones[ ik.effector ];\n\t\t\tconst links = ik.links;\n\t\t\tlet link0, link1;\n\n\t\t\tlink0 = effector;\n\n\t\t\tfor ( let j = 0, jl = links.length; j < jl; j ++ ) {\n\n\t\t\t\tlink1 = bones[ links[ j ].index ];\n\n\t\t\t\tif ( link0.parent !== link1 ) {\n\n\t\t\t\t\tconsole.warn( 'THREE.CCDIKSolver: bone ' + link0.name + ' is not the child of bone ' + link1.name );\n\n\t\t\t\t}\n\n\t\t\t\tlink0 = link1;\n\n\t\t\t}\n\n\t\t}\n\n\t}\n\n}\n\nfunction getPosition( bone, matrixWorldInv ) {\n\n\treturn _vector\n\t\t.setFromMatrixPosition( bone.matrixWorld )\n\t\t.applyMatrix4( matrixWorldInv );\n\n}\n\nfunction setPositionOfBoneToAttributeArray( array, index, bone, matrixWorldInv ) {\n\n\tconst v = getPosition( bone, matrixWorldInv );\n\n\tarray[ index * 3 + 0 ] = v.x;\n\tarray[ index * 3 + 1 ] = v.y;\n\tarray[ index * 3 + 2 ] = v.z;\n\n}\n\n/**\n * Helper for visualizing IK bones.\n *\n * @augments Object3D\n * @three_import import { CCDIKHelper } from 'three/addons/animation/CCDIKSolver.js';\n */\nclass CCDIKHelper extends Object3D {\n\n\t/**\n\t * @param {SkinnedMesh} mesh - The skinned mesh.\n \t * @param {Array<CCDIKSolver~IK>} [iks=[]] - The IK objects.\n \t * @param {number} [sphereSize=0.25] - The sphere size.\n\t */\n\tconstructor( mesh, iks = [], sphereSize = 0.25 ) {\n\n\t\tsuper();\n\n\t\t/**\n\t\t * The skinned mesh this helper refers to.\n\t\t *\n\t\t * @type {SkinnedMesh}\n\t\t */\n\t\tthis.root = mesh;\n\n\t\t/**\n\t\t * The IK objects.\n\t\t *\n\t\t * @type {Array<CCDIKSolver~IK>}\n\t\t */\n\t\tthis.iks = iks;\n\n\t\tthis.matrix.copy( mesh.matrixWorld );\n\t\tthis.matrixAutoUpdate = false;\n\n\t\t/**\n\t\t * The helpers sphere geometry.\n\t\t *\n\t\t * @type {SkinnedMesh}\n\t\t */\n\t\tthis.sphereGeometry = new SphereGeometry( sphereSize, 16, 8 );\n\n\t\t/**\n\t\t * The material for the target spheres.\n\t\t *\n\t\t * @type {MeshBasicMaterial}\n\t\t */\n\t\tthis.targetSphereMaterial = new MeshBasicMaterial( {\n\t\t\tcolor: new Color( 0xff8888 ),\n\t\t\tdepthTest: false,\n\t\t\tdepthWrite: false,\n\t\t\ttransparent: true\n\t\t} );\n\n\t\t/**\n\t\t * The material for the effector spheres.\n\t\t *\n\t\t * @type {MeshBasicMaterial}\n\t\t */\n\t\tthis.effectorSphereMaterial = new MeshBasicMaterial( {\n\t\t\tcolor: new Color( 0x88ff88 ),\n\t\t\tdepthTest: false,\n\t\t\tdepthWrite: false,\n\t\t\ttransparent: true\n\t\t} );\n\n\t\t/**\n\t\t * The material for the link spheres.\n\t\t *\n\t\t * @type {MeshBasicMaterial}\n\t\t */\n\t\tthis.linkSphereMaterial = new MeshBasicMaterial( {\n\t\t\tcolor: new Color( 0x8888ff ),\n\t\t\tdepthTest: false,\n\t\t\tdepthWrite: false,\n\t\t\ttransparent: true\n\t\t} );\n\n\t\t/**\n\t\t * A global line material.\n\t\t *\n\t\t * @type {LineBasicMaterial}\n\t\t */\n\t\tthis.lineMaterial = new LineBasicMaterial( {\n\t\t\tcolor: new Color( 0xff0000 ),\n\t\t\tdepthTest: false,\n\t\t\tdepthWrite: false,\n\t\t\ttransparent: true\n\t\t} );\n\n\t\tthis._init();\n\n\t}\n\n\tupdateMatrixWorld( force ) {\n\n\t\tconst mesh = this.root;\n\n\t\tif ( this.visible ) {\n\n\t\t\tlet offset = 0;\n\n\t\t\tconst iks = this.iks;\n\t\t\tconst bones = mesh.skeleton.bones;\n\n\t\t\t_matrix.copy( mesh.matrixWorld ).invert();\n\n\t\t\tfor ( let i = 0, il = iks.length; i < il; i ++ ) {\n\n\t\t\t\tconst ik = iks[ i ];\n\n\t\t\t\tconst targetBone = bones[ ik.target ];\n\t\t\t\tconst effectorBone = bones[ ik.effector ];\n\n\t\t\t\tconst targetMesh = this.children[ offset ++ ];\n\t\t\t\tconst effectorMesh = this.children[ offset ++ ];\n\n\t\t\t\ttargetMesh.position.copy( getPosition( targetBone, _matrix ) );\n\t\t\t\teffectorMesh.position.copy( getPosition( effectorBone, _matrix ) );\n\n\t\t\t\tfor ( let j = 0, jl = ik.links.length; j < jl; j ++ ) {\n\n\t\t\t\t\tconst link = ik.links[ j ];\n\t\t\t\t\tconst linkBone = bones[ link.index ];\n\n\t\t\t\t\tconst linkMesh = this.children[ offset ++ ];\n\n\t\t\t\t\tlinkMesh.position.copy( getPosition( linkBone, _matrix ) );\n\n\t\t\t\t}\n\n\t\t\t\tconst line = this.children[ offset ++ ];\n\t\t\t\tconst array = line.geometry.attributes.position.array;\n\n\t\t\t\tsetPositionOfBoneToAttributeArray( array, 0, targetBone, _matrix );\n\t\t\t\tsetPositionOfBoneToAttributeArray( array, 1, effectorBone, _matrix );\n\n\t\t\t\tfor ( let j = 0, jl = ik.links.length; j < jl; j ++ ) {\n\n\t\t\t\t\tconst link = ik.links[ j ];\n\t\t\t\t\tconst linkBone = bones[ link.index ];\n\t\t\t\t\tsetPositionOfBoneToAttributeArray( array, j + 2, linkBone, _matrix );\n\n\t\t\t\t}\n\n\t\t\t\tline.geometry.attributes.position.needsUpdate = true;\n\n\t\t\t}\n\n\t\t}\n\n\t\tthis.matrix.copy( mesh.matrixWorld );\n\n\t\tsuper.updateMatrixWorld( force );\n\n\t}\n\n\t/**\n\t * Frees the GPU-related resources allocated by this instance.\n\t * Call this method whenever this instance is no longer used in your app.\n\t */\n\tdispose() {\n\n\t\tthis.sphereGeometry.dispose();\n\n\t\tthis.targetSphereMaterial.dispose();\n\t\tthis.effectorSphereMaterial.dispose();\n\t\tthis.linkSphereMaterial.dispose();\n\t\tthis.lineMaterial.dispose();\n\n\t\tconst children = this.children;\n\n\t\tfor ( let i = 0; i < children.length; i ++ ) {\n\n\t\t\tconst child = children[ i ];\n\n\t\t\tif ( child.isLine ) child.geometry.dispose();\n\n\t\t}\n\n\t}\n\n\t// private method\n\n\t_init() {\n\n\t\tconst scope = this;\n\t\tconst iks = this.iks;\n\n\t\tfunction createLineGeometry( ik ) {\n\n\t\t\tconst geometry = new BufferGeometry();\n\t\t\tconst vertices = new Float32Array( ( 2 + ik.links.length ) * 3 );\n\t\t\tgeometry.setAttribute( 'position', new BufferAttribute( vertices, 3 ) );\n\n\t\t\treturn geometry;\n\n\t\t}\n\n\t\tfunction createTargetMesh() {\n\n\t\t\treturn new Mesh( scope.sphereGeometry, scope.targetSphereMaterial );\n\n\t\t}\n\n\t\tfunction createEffectorMesh() {\n\n\t\t\treturn new Mesh( scope.sphereGeometry, scope.effectorSphereMaterial );\n\n\t\t}\n\n\t\tfunction createLinkMesh() {\n\n\t\t\treturn new Mesh( scope.sphereGeometry, scope.linkSphereMaterial );\n\n\t\t}\n\n\t\tfunction createLine( ik ) {\n\n\t\t\treturn new Line( createLineGeometry( ik ), scope.lineMaterial );\n\n\t\t}\n\n\t\tfor ( let i = 0, il = iks.length; i < il; i ++ ) {\n\n\t\t\tconst ik = iks[ i ];\n\n\t\t\tthis.add( createTargetMesh() );\n\t\t\tthis.add( createEffectorMesh() );\n\n\t\t\tfor ( let j = 0, jl = ik.links.length; j < jl; j ++ ) {\n\n\t\t\t\tthis.add( createLinkMesh() );\n\n\t\t\t}\n\n\t\t\tthis.add( createLine( ik ) );\n\n\t\t}\n\n\t}\n\n}\n\n/**\n * This type represents IK configuration objects.\n *\n * @typedef {Object} CCDIKSolver~IK\n * @property {number} target - The target bone index which refers to a bone in the `Skeleton.bones` array.\n * @property {number} effector - The effector bone index which refers to a bone in the `Skeleton.bones` array.\n * @property {Array<CCDIKSolver~BoneLink>} links - An array of bone links.\n * @property {number} [iteration=1] - Iteration number of calculation. Smaller is faster but less precise.\n * @property {number} [minAngle] - Minimum rotation angle in a step in radians.\n * @property {number} [maxAngle] - Minimum rotation angle in a step in radians.\n * @property {number} [blendFactor] - The blend factor.\n **/\n\n/**\n * This type represents bone links.\n *\n * @typedef {Object} CCDIKSolver~BoneLink\n * @property {number} index - The index of a linked bone which refers to a bone in the `Skeleton.bones` array.\n * @property {number} [limitation] - Rotation axis.\n * @property {number} [rotationMin] - Rotation minimum limit.\n * @property {number} [rotationMax] - Rotation maximum limit.\n * @property {boolean} [enabled=true] - Whether the link is enabled or not.\n **/\n\n\nexport { CCDIKSolver, CCDIKHelper };\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}